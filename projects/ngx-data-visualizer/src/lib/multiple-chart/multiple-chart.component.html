<div class="charts-container">
  <!-- @if (chartConfigurations()) { -->
    @for (chartConfiguration of chartConfigurations(); track $index) {
      <div
        #chartItem
        [id]="getChartItemId($index)"
        class="chart-item"
        [attr.data-index]="$index"
      >
        <!-- Botón de navegación hacia atrás -->
        @if ($index !== 0) {
          <button
            class="icon-nav back"
            (click)="moveToChartItem(getChartItemId($index - 1))"
            type="button"
            [attr.aria-label]="'Gráfico anterior'"
          >
            <lib-icon-back></lib-icon-back>
          </button>
        }

        <!-- Contenedor del gráfico -->
        <div class="chart-wrapper">
          <ng-container
            *ngComponentOutlet="
              chartComponent;
              inputs: { chartConfiguration: chartConfiguration }
            "
          ></ng-container>
        </div>

        <!-- Botón de navegación hacia adelante -->
        @if ($index !== chartConfigurations().length - 1) {
          <button
            class="icon-nav forward"
            (click)="moveToChartItem(getChartItemId($index + 1))"
            type="button"
            [attr.aria-label]="'Siguiente gráfico'"
          >
            <lib-icon-forward></lib-icon-forward>
          </button>
        }

        <!-- Botón para expandir/contraer el gráfico -->
        @if (chartConfiguration.expanded) {
          <button
            class="icon-expand"
            (click)="expandChartItem(chartItem, chartConfiguration)"
            type="button"
            [attr.aria-label]="'Contraer gráfico'"
          >
            <lib-icon-contract></lib-icon-contract>
          </button>
        } @else {
          <button
            class="icon-expand"
            (click)="expandChartItem(chartItem, chartConfiguration)"
            type="button"
            [attr.aria-label]="'Expandir gráfico'"
          >
            <lib-icon-expand></lib-icon-expand>
          </button>
        }

        <!-- Indicador de posición en mobile -->
        <div class="mobile-indicator">
          <span class="current-position">{{ $index + 1 }}</span>
          <span class="separator">/</span>
          <span class="total-count">{{ chartConfigurations().length }}</span>
        </div>
      </div>
    }
  <!-- } -->
</div>
